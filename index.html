<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>‚öΩ Live B√≥ng ƒê√° Vi·ªát Nam</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    iframe {
      margin-top: 20px;
      width: 720px;
      height: 405px;
      border: none;
    }
  </style>
</head>
<body>

<h1>‚öΩ Live B√≥ng ƒê√° Vi·ªát Nam ‚öΩ</h1>
<div id="video-container">
  <p>ƒêang ki·ªÉm tra tr·∫≠n ƒë·∫•u...</p>
</div>

<script>
const API_KEY = 'AIzaSyDUaEAdkfCAJQu1iUQQyd16uAYYWfjTX_8'; // üî• ƒêi·ªÅn API KEY c·ªßa b·∫°n v√†o ƒë√¢y
const CHANNEL_ID = 'UCtP3bFpuG3JlvON2F2I2jTQ'; // üî• ID k√™nh c·∫ßn l·∫•y live
let currentVideoId = "";

async function fetchLiveVideo() {
  try {
    const apiUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&eventType=live&type=video&key=${API_KEY}`;
    const response = await fetch(apiUrl);
    const data = await response.json();

    if (data.items && data.items.length > 0) {
      const videoId = data.items[0].id.videoId;
      if (currentVideoId !== videoId) {
        console.log('Ph√°t hi·ªán live m·ªõi:', videoId);
        currentVideoId = videoId;
        showVideo(videoId);
      }
    } else {
      console.log('Kh√¥ng c√≥ video live.');
      if (!currentVideoId) {
        document.getElementById('video-container').innerHTML = '<p>üî¥ Hi·ªán t·∫°i ch∆∞a c√≥ ph√°t tr·ª±c ti·∫øp!</p>';
      }
    }
  } catch (error) {
    console.error('L·ªói khi fetch live:', error);
    if (!currentVideoId) {
      document.getElementById('video-container').innerHTML = '<p>üî¥ Kh√¥ng th·ªÉ k·∫øt n·ªëi!</p>';
    }
  }
}

function showVideo(videoId) {
  const iframeHtml = `
    <iframe id="ytplayer" src="https://www.youtube.com/embed/${videoId}?autoplay=1&enablejsapi=1" allow="autoplay" allowfullscreen></iframe>
  `;
  document.getElementById('video-container').innerHTML = iframeHtml;
  setTimeout(initYouTubeAPI, 1000); // ƒê·ª£i iframe load xong r·ªìi m·ªõi attach API
}

function initYouTubeAPI() {
  if (typeof YT === 'undefined') {
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);
  } else {
    onYouTubeIframeAPIReady();
  }
}

function onYouTubeIframeAPIReady() {
  player = new YT.Player('ytplayer', {
    events: {
      'onStateChange': onPlayerStateChange
    }
  });
}

function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.ENDED) {
    console.log("Video k·∫øt th√∫c, t√¨m tr·∫≠n m·ªõi...");
    currentVideoId = "";
    fetchLiveVideo();
  }
}

// G·ªçi l·∫ßn ƒë·∫ßu khi m·ªü trang
fetchLiveVideo();

// C·ª© 30 ph√∫t ki·ªÉm tra 1 l·∫ßn
setInterval(fetchLiveVideo, 1800000); // 1800000 ms = 30 ph√∫t
</script>

</body>
</html>
