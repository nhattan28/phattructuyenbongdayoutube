<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>‚öΩ Live B√≥ng ƒê√° Vi·ªát Nam ‚öΩ</title>
  <style>
    body {
      background-color: black;
      color: white;
      text-align: center;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    iframe {
      margin-top: 20px;
      width: 720px;
      height: 405px;
      border: none;
    }
  </style>
</head>
<body>

<h1>‚öΩ Live B√≥ng ƒê√° Vi·ªát Nam ‚öΩ</h1>
<div id="video-container">
  <p>ƒêang t√¨m tr·∫≠n b√≥ng ƒë√° ph√°t tr·ª±c ti·∫øp...</p>
</div>

<script>
const apiKey = 'AIzaSyDUaEAdkfCAJQu1iUQQyd16uAYYWfjTX_8'; // üî• API KEY c·ªßa b·∫°n
const channelIds = [
  'UCk2YNy1wJKVxY_wJkaMf2Ow', // VTV Th·ªÉ Thao
  'UCIsvJ6JTXsI6U7rTZg4sRVA', // Next Sports
  'UCmC9o_WLP-QA1z7nEN7aB0g', // VFF Channel
  'UCzXAFyJydzWfF3Q5kSEu1-A', // On Sports
  'UCRPL92H_gYVBvr_7RWopL5g', // FPT Play Sports
  'UCg1WWbGldxzkOIFFp0miE_g'  // SCTV15
  'UC-3jRPfMG9kJfv9IpkM0Y9w', // K√™nh B√≥ng ƒê√° Vi·ªát Nam 2023
  'UCOcXQh1Tz9WZzqVaki-MP3w', // B√≥ng ƒê√° H√¥m Nay 456
];
let currentVideoId = "";

async function fetchLiveVideo() {
  try {
    for (const channelId of channelIds) {
      const apiUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&eventType=live&type=video&maxResults=1&key=${apiKey}`;
      const response = await fetch(apiUrl);
      const data = await response.json();

      if (data.items && data.items.length > 0) {
        const videoId = data.items[0].id.videoId;
        if (currentVideoId !== videoId) {
          console.log("ƒê√£ t√¨m th·∫•y video live m·ªõi:", videoId);
          currentVideoId = videoId;
          loadVideo(videoId);
        } else {
          console.log("ƒê√£ c√≥ live, kh√¥ng c·∫ßn ƒë·ªïi.");
        }
        return; // D·ª´ng t√¨m ti·∫øp n·∫øu ƒë√£ c√≥ live
      }
    }
    // N·∫øu qu√©t h·∫øt m√† kh√¥ng c√≥ live
    if (!currentVideoId) {
      document.getElementById('video-container').innerHTML = `
        <p>üî¥ Hi·ªán t·∫°i k√™nh ch∆∞a ph√°t tr·ª±c ti·∫øp!<br>M·ªùi b·∫°n quay l·∫°i sau nh√©!</p>
      `;
    }
  } catch (error) {
    console.error('L·ªói fetch:', error);
    document.getElementById('video-container').innerHTML = '<p>‚ùó L·ªói khi t√¨m video.</p>';
  }
}

function loadVideo(videoId) {
  const iframeHtml = `
    <iframe id="ytplayer" width="720" height="405"
      src="https://www.youtube.com/embed/${videoId}?autoplay=1&mute=0&enablejsapi=1"
      frameborder="0" allowfullscreen allow="autoplay"></iframe>
  `;
  document.getElementById('video-container').innerHTML = iframeHtml;

  // Kh·ªüi ƒë·ªông ki·ªÉm tra n·∫øu video die
  setTimeout(initYouTubeAPI, 2000);
}

function initYouTubeAPI() {
  if (typeof YT === 'undefined') {
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);
  } else {
    onYouTubeIframeAPIReady();
  }
}

function onYouTubeIframeAPIReady() {
  if (typeof YT.Player !== 'undefined') {
    new YT.Player('ytplayer', {
      events: {
        'onStateChange': onPlayerStateChange
      }
    });
  }
}

function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.ENDED || event.data === YT.PlayerState.UNSTARTED) {
    console.log("Video ƒë√£ k·∫øt th√∫c ho·∫∑c die, t√¨m live m·ªõi...");
    currentVideoId = "";
    fetchLiveVideo();
  }
}

// G·ªçi l·∫ßn ƒë·∫ßu
fetchLiveVideo();

// C·ª© 30 ph√∫t ki·ªÉm tra 1 l·∫ßn n·∫øu ƒëang kh√¥ng live
setInterval(() => {
  if (!currentVideoId) {
    console.log("Kh√¥ng c√≥ live, ki·ªÉm tra l·∫°i...");
    fetchLiveVideo();
  }
}, 1800000); // 30 ph√∫t
</script>

</body>
</html>
